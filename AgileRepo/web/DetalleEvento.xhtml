<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templateEventos.xhtml"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:define name="title">#{detallecontroller.nombreEvento}</ui:define>

    <ui:define name="head">

        <f:metadata>
            <f:viewAction action="#{detallecontroller.onLoad()}" />
        </f:metadata>


        <script type="text/javascript">
            //<![CDATA[
            function skinChart() {
                this.cfg.shadow = false;
                this.cfg.title = '';
                this.cfg.seriesColors = ['#007be5', '#20d077'];
                this.cfg.grid = {
                    background: '#ffffff',
                    borderColor: '#ffffff',
                    gridLineColor: '#F5F5F5',
                    shadow: false
                };
                this.cfg.axesDefaults = {
                    rendererOptions: {
                        textColor: '#666F77'
                    }
                };
                this.cfg.seriesDefaults = {
                    shadow: false,
                    lineWidth: 1,
                    markerOptions: {
                        shadow: false,
                        size: 7,
                        style: 'circle'
                    }
                }
            }
            //]]>  
        </script>



        <style type="text/css">
            .main-content {
                padding: 0;
            }
        </style>

    </ui:define>

    <ui:define name="content">



        <div class="dashboard" style="height:100%; width:100%; min-height:100%; ">




            <h:form id="eventos" style="height:100%; width:100%; min-height:100%;" >

                <!-->
                Este es el control que se encarga del drag and drop. Trae una 
                lista de los "detalles"(slots), que coinciden con el id del 
                evento que se clickeó en el dashboard
                
                </!-->


                <p:orderList id="ord" value="#{detallecontroller.detalles}" var="detalle"
                             itemLabel="#{detalle}" controlsLocation="none" converter="#{detalleconverter}" itemValue="#{detalle}"  responsive="true" 
                             style="height:100%; width:100%; min-height:100%;">

                    <p:ajax event="reorder" listener="#{detallecontroller.onReorder()}"/>

                    <!-->
                    Esto es lo que controla las tarjetas. 
                    Para los estilos, revisar layout.css y myLogin.css 
                    </!-->

                    <p:column style="width:100%; height:100%;">

                        <div class="#{detalle.esBloque()?'card2':'card'} clearfix summary">
                            <div style="width:90%">
                            <div style="visibility: #{detalle.esBloque()?'hidden':'visible'}">                                


                                <span class="options">


                                    <p:commandButton  action="#{detallecontroller.outcome()}" icon="pi pi-cog" update="Slot" >
                                        <f:param name="tituloSlot" value="#{detalle.titulo}" />
                                        <f:param name="idSlot" value="#{detalle.id}" />
                                        <f:param name="descSlot" value="#{detalle.descripcion}" />
                                        <f:param name="objSlot" value="#{detalle.objetivo}" />
                                        <f:param name="catSlot" value="#{detalle.categoria}" />
                                        <f:param name="colcatSlot" value="#{detalle.colorCategoria}" />
                                        <f:param name="pasSlot" value="#{detalle.pasos}" />
                                        <f:param name="matSlot" value="#{detalle.materiales}" />
                                        <f:ajax onevent="PF('side_info').show()"/>
                                    </p:commandButton>

                                </span>

                            </div>
                            </div>
                            
                            
                             <!--->
                             Este es el html del botón que muestra la duración de 
                             un slot. Llama a un par de parámetros necesarios para 
                             la edición de la duración de un slot
                            </!-->
                           
                            <p:commandButton id="btnDuracion" class="btnDuracion" value="#{detalle.duracion}" style="background-color:##{detalle.colorCategoria}; font-size:18px; font-weight:bold; display:#{detalle.esBloque()?'none':'block'}" action="#{detallecontroller.outcomeDuracion()}" update="duracionForm" oncomplete="PF('editDuracion').show();" >
                                <f:param name="idSlot" value="#{detalle.id}" /> 
                                <f:param name="duracionSlot" value="#{detalle.duracion}" /> 
                            </p:commandButton>
                          
                            
                            <div style="width:90%">
                                <span id="tit" class="#{detalle.esBloque()?'title2':'title'}">#{detalle.titulo}</span>

                            </div>
                            
                            
                             <!--->
                             Aquí está el html que muestra la hora inicial y, 
                             si aplica, también el botón de editar esta.
                             El botón llama a un par de parámetros necesarios para 
                             la edición de las horas de inicio de un slot
                             </!-->
                            
                              <div class="hora" style="display:#{detalle.esBloque()?'none':'inline-block'}">
                                
                               <span  id="hora"  >#{detalle.horaInicioStr}</span>
                               <p:commandButton id="setHora" icon="pi pi-clock" value="EDITAR" class="horabtn"  style="display:#{detalle.esPrimeroDia()?'block':'none'}" action="#{detallecontroller.outcomeHora()}" update="horaForm" oncomplete="PF('editHora').show();">
                                   <f:param name="horaSlot" value="#{detalle.horaInicioStr}" />
                                   <f:param name="idSlot" value="#{detalle.id}" /> 
                               </p:commandButton>    
                       
                            </div>
                           

                            <div >
                                <span class="detail" style="display:#{detalle.esBloque()?'none':'inline'}">#{detalle.descripcion}</span>
                            </div>


                            
                           
                            
                            
                            

                        </div>


                    </p:column>  



                </p:orderList>       


            </h:form>
            <!--Esto controla el sidebar que aparece de la derecha donde se puede editar la informacion
            de los slots-->
            <p:sidebar id="sidebarslot" widgetVar="side_info" position="right" baseZIndex='0' style="background: white;width: 100%; height: 100%; overflow: scroll;">

                <h:form id="Slot">
                    <h1>Título</h1>
                    <p:inputTextarea id="titulo" rows="1" placeholder="TITULO DEL SLOT" readonly="false" value="#{detallecontroller.titulo}" style="width:90%; font-size: 20px;">
                        <f:validateLength maximum="50" />
                        <p:clientValidator event="keyup"/>
                    </p:inputTextarea>
                    <p:message for="titulo" display="text" />
                    <p:separator />

                    <h1>Descripción</h1>
                    <p:inputTextarea id="descripcion" rows="4" placeholder="DESCRIPCION" readonly="false" value="#{detallecontroller.descripcion}" style="width:90%; font-size: 14px;">
                        <f:validateLength maximum="280" />
                        <p:clientValidator event="keyup"/>
                    </p:inputTextarea>
                    <p:message for="descripcion" display="text" />  
                    <h1>Objetivo</h1>
                    <p:inputTextarea id="objetivo" rows="4" placeholder="OBJETIVO" readonly="false" value="#{detallecontroller.objetivo}" style="width:90%; font-size: 14px;">
                        <f:validateLength maximum="280" />
                        <p:clientValidator event="keyup"/>
                    </p:inputTextarea>
                    <p:message for="objetivo" display="text" />  
                    <p:separator />

                    <h1>Categoría</h1>

                    <h:panelGrid columns="2" cellpadding="5" style="margin-left: 20px">
                        <p:inputTextarea id="categoria" rows="1" placeholder="CATEGORIA" readonly="false" value="#{detallecontroller.categoria}" style="width:150px; font-size: 14px;">
                            <f:validateLength maximum="50" />
                            <p:clientValidator event="keyup"/>
                        </p:inputTextarea>
                        <p:message for="categoria" display="text" />  
                        <p:colorPicker value="#{detallecontroller.colorCategoria}" onchange="#{detallecontroller.colorCategoria}" />
                    </h:panelGrid>
                    <p:separator />

                    <h1>Pasos</h1>
                    <p:inputTextarea id="pasos" rows="5" placeholder="Pasos" readonly="false" value="#{detallecontroller.pasos}" style="width:90%; font-size: 14px;">
                        <f:validateLength maximum="2000" />
                        <p:clientValidator event="keyup"/>
                    </p:inputTextarea>
                    <p:message for="pasos" display="text" />  
                    <h1>Materiales</h1>
                    <p:inputTextarea id="materiales" rows="5" placeholder="Materiales" readonly="false" value="#{detallecontroller.materiales}" style="width:90%; font-size: 14px;">
                            <f:validateLength maximum="2000" />
                        <p:clientValidator event="keyup"/>
                    </p:inputTextarea>
                    <p:message for="materiales" display="text" />  
                    <p:separator />

                    <h:panelGrid  columns="2" cellpadding="5" style="margin-left: 20px">
                        <p:commandButton  id="btnSlot"  value="Guardar" actionListener="#{detallecontroller.updateSlot()}" update="eventos" validateClient="true" />
                        <p:commandButton value="Cerrar" oncomplete="PF('side_info').hide()"/>
                    </h:panelGrid>


                </h:form>

            </p:sidebar> 


             <!--->
           Modal que aparece al pulsar el botón editar que se encuentra en los 
             slots catalogados como primerosDeDia
           </!-->
            
            <p:dialog header="EDITAR HORA" widgetVar="editHora" minHeight="100" style="background:white;">
                   <h:form id="horaForm">
                       <h:panelGrid columns="2">
                         <h:outputText value="Hora:" /> 
                         <p:inputText id="txtHora" required="true" value="#{detallecontroller.horaEdit}" ></p:inputText>  

             
                         <p><p:commandButton id="guardarHora"  value="Guardar" action="#{detallecontroller.editarHora()}"
                                   update="eventos" oncomplete="PF('editHora').hide();"/></p>          
                       </h:panelGrid>  
                       
                   </h:form>
                
            </p:dialog>
            
            
            
           <!--->
           Modal que aparece al pulsar el botón que muestra la duración del slot
           </!-->
            <p:dialog header="EDITAR DURACIÓN" widgetVar="editDuracion" minHeight="100" style="background:white;">
                   <h:form id="duracionForm">
                       <h:panelGrid columns="2">
                         <h:outputText value="Duración:" /> 
                         <p:inputText id="txtDuracion" required="true" value="#{detallecontroller.duracionEdit}" ></p:inputText>  

             
                         <p><p:commandButton id="guardarDuracion"  value="Guardar" action="#{detallecontroller.editarDuracion()}"
                                   update="eventos" oncomplete="PF('editDuracion').hide();"/></p>          
                       </h:panelGrid>  
                       
                   </h:form>
                
            </p:dialog>
            
        </div>

        <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces" />

    </ui:define>


</ui:composition>