<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml"
                xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:define name="title">Eventos</ui:define>

    <ui:define name="head">
        <f:metadata>
            <f:viewAction action="#{eventcontroller.onLoad()}" />
        </f:metadata>

        <script type="text/javascript">
            //<![CDATA[
            function skinChart() {
                this.cfg.shadow = false;
                this.cfg.title = '';
                this.cfg.seriesColors = ['#007be5', '#20d077'];
                this.cfg.grid = {
                    background: '#ffffff',
                    borderColor: '#ffffff',
                    gridLineColor: '#F5F5F5',
                    shadow: false
                };
                this.cfg.axesDefaults = {
                    rendererOptions: {
                        textColor: '#666F77'
                    }
                };
                this.cfg.seriesDefaults = {
                    shadow: false,
                    lineWidth: 1,
                    markerOptions: {
                        shadow: false,
                        size: 7,
                        style: 'circle'
                    }
                }
            }
            //]]>  
        </script>
        <style type="text/css">
            .main-content {
                padding: 0;
            }
        </style>

    </ui:define>

    <ui:define name="content" id="content" >
        <div class="ui-g ui-fluid dashboard" >
            <div class="ui-g-12" >
                <!-->
                Esto vendría a ser como un For. Lo que está haciendo es tomar
                la lista de eventos(que se obtiene de base de datos 
                usando eventDao) de eventcontroller, recorrerla y armar 
                tarjetas con cada uno de los objetos de tipo Evento que 
                contiene.
                
                </!-->
                <h:panelGroup  id="padre">
                    <c:forEach  id="repeat"  items="#{eventcontroller.lstEvt}" var="eventos" varStatus="true" >
                        <h:form id="evt">

                            <div class="card clearfix summary" >



                                <h:commandButton styleClass="boton" rendered="#{!eventos.onEdit}" action="#{detallecontroller.redireccionar(eventos.id,eventos.nombre)}">

                                </h:commandButton>

                                <!-->
                                Aquí está el título del evento y su duración
                                </!-->
                                <h:panelGrid columns="2">
                                    <span  class="count visitors">#{eventos.duracion}</span>
                                    <span  class="count visitors">#{eventos.horaInicio}</span>
                                </h:panelGrid>


                                <br></br>


                                <div style="width:90%" contenteditable="#{eventos.onEdit}">   
                                    <h:inputText style="border: none; overflow:hidden; display:#{eventos.retornarEdit()? 'none':'block'}; width:100%; font-family:Arial,Helvetica; margin-top:0px; background:none; margin-left:10px;" class="title" value="#{eventos.tituloCorto}"></h:inputText>
                                    <h:inputText style="border: none; overflow:hidden; display:#{eventos.retornarEdit()? 'block':'none'}; width:100%; font-family:Arial,Helvetica; margin-top:0px; background:none; margin-left:10px;" class="title" value="#{eventos.nombre}"></h:inputText>

                                </div>




                                <!-->
                            Este es el botón "..."
                             </!-->

                                <div >

                                    <span class="options">

                                        <p:graphicImage id="smallmenu" name="images/opcionesIcon.png" library="omega-layout" width="20px" style="margin-right:0"/>
                                        <p:menu overlay="true" trigger="smallmenu" my="left  op" at="left bottom">
                                            <p:menuitem value="Editar" icon="ui-icon-pencil"  action="#{eventos.setOnEdit(true)}"  update=":padre" >
                                                <f:actionListener binding="#{eventos.setOnRowEdit(2)}"/>
                                                <f:actionListener binding="#{eventcontroller.setColorCode(eventcontroller.BLACKCOLORCODE)}"/>
                                            </p:menuitem>
                                            <p:menuitem value="Cronograma" actionListener="#{eventcontroller.CronoListener}"  icon="ui-icon-clipboard fa fa-clipboard">
                                                <f:attribute name="getEvt" value="#{eventos}"/>
                                            </p:menuitem>

                                            <p:menuitem value="Borrar" icon="ui-icon-close fa fa-close"  actionListener="#{eventcontroller.deleteListener}">
                                                <!--Etiqueta para enviar valor a un bean mediante su evento click-->
                                                <f:attribute name="delItem" value="#{eventos}" />
                                            </p:menuitem>
                                        </p:menu>
                                    </span>

                                </div>
                                <!-->
                              Aquí está la descripción, simplemente accede al 
                                String "desc" del objeto Evento actual de la lista
                              </!-->    

                                <div contenteditable="#{eventos.onEdit}">
                                    <!--<span class="detail">#{eventos.desc}</span>-->
                                    <h:inputTextarea rows="#{eventos.onRowEdit}" cols="1" readonly="#{!eventos.onEdit}" style="overflow:hidden;display: block;width: 90%;border: none;resize: none; font-family:Arial,Helvetica;" class="detail" value="#{eventos.desc}"> </h:inputTextarea>
                                </div>


                                <!-->
                               Aquí están los tags, los cuales vienen en un solo 
                                String, separados por espacios y demarcados con 
                                "#" 
                               </!-->   

                                <div class="tags" style="display: block;width: 80%;border: none" contenteditable="#{eventos.onEdit}">
                                    <h:inputText id="tags" value="#{eventos.losTags}" readonly="#{!eventos.onEdit}"   style="display: block;border: none;color: #{eventcontroller.colorCode}">

                                    </h:inputText>
                                </div>
                                <p:commandButton
                                    icon="fa fa-comment"
                                    value="Comentar"
                                    rendered="#{not eventos.onEdit}"
                                    style="text-align: center;margin: 8px;position: absolute;bottom: 0;right: 0;width:100px;"
                                    >
                                </p:commandButton>
                                <h:commandButton
                                    rendered="#{eventos.onEdit}"
                                    action="#{eventcontroller.edit(eventos)}"
                                    type="submit"
                                    value="Hecho"
                                    style="text-align: center;margin: 8px;position: absolute;bottom: 0;right: 0;width:100px;"
                                    class=" btnCopy btnCopy--omega" >
                                    <f:actionListener binding="#{eventos.setOnRowEdit(1)}"></f:actionListener>
                                    <f:actionListener binding="#{eventcontroller.setColorCode(eventcontroller.BLUECOLORCODE)}"></f:actionListener>
                                    <f:actionListener binding="#{eventos.setOnEdit(false)}"></f:actionListener>
                                </h:commandButton>
                                <p:tooltip id="toolTipTrack" for="tags" value="Los Tags son válidos unicamente cuando estos están precedidos por un # y el nombre del Tag" trackMouse="true" />
                            </div>
                        </h:form>
                    </c:forEach>


                    <h:form id="frmDlg">
                        <div>
                            <p:dialog header="Cronograma" id="dlg1" draggable="false" style="text-align: center;  align-items: center; bottom: 50;right: 50;width:417px;" widgetVar="dlg2" modal="true" resizable="false" responsive="true" width="414px" >

                                <div style="padding: 0px;">
                                    <p:scrollPanel id="scrl" style="width:250px;height:200px">
                                        <c:forEach   id="P111"  items="#{eventcontroller.lstCrono}" var="P1" varStatus="true"  > 

                                            <div style="border-radius:3% ;margin-bottom: 0.2em;border: 0.1em;border-color: #0388e5;border-style: solid;padding: 10px;width: 90% ;display:#{P1.esBloque()?'none':'inline-block'} ">
                                                <span style="font-size: x-large;width: 52px;height: 52px" >#{P1.ord}) </span>
                                                <span style="display: inline-block;width: 80px;height: 100%;margin-right:  13px;border-radius: 10% ;color: #ffffff;align-content: center;text-align: center ;font-size: x-large;background-color: ##{P1.color} !important;">#{P1.horaInicio}</span>
                                                <span style="font-size: x-large;width: 56px;height: 52px" >-</span>
                                                <span style="display: inline-block;width: 80px;height: 100%;margin-right:  13px;border-radius: 10% ;color: #ffffff;align-content: center;text-align: center ;font-size: x-large;background-color: ##{P1.color} !important;">#{P1.horaFinal}</span>
                                                <span style="font-size: x-large;width: 56px;height: 52px" >#{P1.titulo}</span>
                                                <span style="font-size: x-large;width: 52px;height: 52px" > D:#{P1.duracion}m</span>
                                            </div>

                                            <div style="border-radius:3% ;margin-bottom: 0.2em;border: 0.1em;border-color: #0388e5;border-style: solid;padding: 10px;display:#{P1.esBloque()?'inline-block':'none'};width: 90%;"  >
                                                <span style="font-size: x-large;width: 52px;height: 52px" >#{P1.ord})  </span>
                                                <span style="font-size: x-large;width: 56px;height: 52px" >#{P1.titulo}</span>
                                            </div>

                                        </c:forEach>

                                    </p:scrollPanel>

                                    <p:commandButton value="Print" type="button" icon="pi pi-print" style="display:block;margin-bottom: 20px">
                                        <p:printer target="scrl" />
                                    </p:commandButton>

                                </div>
                            </p:dialog>   
                        </div>
                    </h:form>



                </h:panelGroup>

            </div>
        </div>
        <h:outputStylesheet name="css/myDashboard.css" library="omega-layout" ></h:outputStylesheet>

        <!--Dialogo de confirmacion antes de la eliminacion-->
        <h:form style="text-align: center">
            <p:confirmDialog message="Desea eliminar el evento?" header="Eliminación de evento" severity="alert" widgetVar="cd">
                <p:commandButton style="display: block;width: 100%" action="#{eventcontroller.delete()}" value="Sí,seguro"  oncomplete="PF('cd').hide()">
                </p:commandButton>
                <p:commandButton  style="display: block;width: 100%" value="No aún" onclick="PF('cd').hide();" type="button" />
            </p:confirmDialog>
        </h:form>
    </ui:define>

</ui:composition>